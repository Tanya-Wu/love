<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‹çˆ±å æœ‰æ¬²æ·±åº¦æµ‹è¯•</title>
    
    <!-- å”¯ä¸€çš„ä¸€ä¸ªå¤–éƒ¨é“¾æ¥ï¼Œåªç”¨äºç”Ÿæˆå›¾ç‰‡åŠŸèƒ½ï¼Œä½¿ç”¨å›½å†…æœ€å¿«çš„å­—èŠ‚è·³åŠ¨æº -->
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* --- 1. æ ·å¼å®šä¹‰åŒº (æ‰‹å†™åŸç”Ÿ CSS è¿˜åŸ Tailwind é£æ ¼) --- */
        :root {
            --pink-50: #fdf2f8;
            --pink-100: #fce7f3;
            --pink-500: #ec4899;
            --pink-600: #db2777;
            --red-50: #fef2f2;
            --red-500: #ef4444;
            --purple-500: #a855f7;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--pink-50);
            color: var(--gray-800);
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* é¡¶éƒ¨å½©æ¡ */
        .top-bar { height: 8px; background: linear-gradient(to right, #f472b6, #f87171, #a855f7); flex-shrink: 0; }

        /* é€šç”¨å®¹å™¨ */
        .container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            max-width: 480px;
            margin: 0 auto;
            width: 100%;
            display: none; /* é»˜è®¤éšè—ï¼ŒJSæ§åˆ¶æ˜¾ç¤º */
            animation: fadeIn 0.4s ease-out;
        }
        
        .container.active { display: flex; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* é¦–é¡µæ ·å¼ */
        .intro-content { text-align: center; justify-content: center; height: 90vh; }
        .icon-circle { background: var(--pink-100); padding: 20px; border-radius: 50%; display: inline-block; margin-bottom: 20px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        
        .title { font-size: 28px; font-weight: bold; margin-bottom: 8px; line-height: 1.3; }
        .subtitle { color: #6b7280; font-size: 14px; margin-bottom: 30px; }
        
        .card { background: var(--gray-50); padding: 20px; border-radius: 12px; text-align: left; font-size: 14px; color: #4b5563; margin-bottom: 30px; box-shadow: inset 0 2px 4px 0 rgba(0,0,0,0.05); }
        .card ul { padding-left: 20px; margin: 10px 0 0 0; }
        
        /* æŒ‰é’®é€šç”¨æ ·å¼ */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background: linear-gradient(to right, #ec4899, #ef4444);
            border: none;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.96); }
        .btn-restart { background: var(--gray-100); color: #4b5563; margin-right: 10px; }
        
        /* ç­”é¢˜é¡µæ ·å¼ */
        .progress-bar-bg { height: 8px; background: var(--gray-100); border-radius: 99px; overflow: hidden; margin-bottom: 30px; }
        .progress-bar-fill { height: 100%; background: var(--pink-500); width: 0%; transition: width 0.3s; }
        .q-tag { background: var(--pink-100); color: var(--pink-600); font-size: 12px; font-weight: bold; padding: 4px 12px; border-radius: 99px; display: inline-block; margin-bottom: 15px; }
        .q-text { font-size: 20px; font-weight: 500; line-height: 1.6; margin-bottom: 40px; min-height: 80px; }
        
        .option-btn {
            width: 100%; padding: 16px 20px; margin-bottom: 12px;
            background: white; border: 2px solid transparent; border-radius: 12px;
            text-align: left; font-size: 16px; font-weight: 500;
            display: flex; justify-content: space-between; align-items: center;
            transition: all 0.2s; cursor: pointer;
        }
        .option-btn:active { transform: scale(0.98); }
        /* é€‰é¡¹ç‰¹å®šé¢œè‰² */
        .opt-5 { background: #fef2f2; color: #b91c1c; border-color: #fecaca; }
        .opt-4 { background: #fdf2f8; color: #be185d; border-color: #fbcfe8; }
        .opt-3 { background: #f9fafb; color: #374151; border-color: #e5e7eb; }
        .opt-2 { background: #eff6ff; color: #1d4ed8; border-color: #bfdbfe; }
        .opt-1 { background: #f0fdf4; color: #15803d; border-color: #bbf7d0; }

        /* ç»“æœé¡µæ ·å¼ */
        .result-header {
            background: var(--gray-900); color: white; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px;
            padding: 40px 30px 60px 30px; text-align: center; margin: -20px -20px 20px -20px; position: relative; overflow: hidden;
        }
        .score-num { font-size: 72px; font-weight: bold; background: linear-gradient(to right, #f9a8d4, #d8b4fe); -webkit-background-clip: text; color: transparent; margin: 10px 0; }
        .level-badge { display: inline-block; padding: 4px 16px; border-radius: 99px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); font-size: 14px; }
        
        .analysis-card { background: white; border-radius: 16px; padding: 24px; margin-bottom: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); animation: slideUp 0.5s ease-out; }
        .card-title { display: flex; align-items: center; gap: 10px; font-weight: bold; margin-bottom: 12px; color: var(--gray-800); }
        .icon-box { padding: 8px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .card-text { font-size: 14px; color: #4b5563; line-height: 1.6; text-align: justify; }

        /* åº•éƒ¨æ“ä½œæ  */
        .bottom-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
            padding: 15px 20px 30px 20px; display: flex; z-index: 100;
            box-shadow: 0 -4px 10px rgba(0,0,0,0.05);
        }
        
        .footer-watermark { text-align: center; font-size: 10px; color: #9ca3af; padding: 20px 0; width: 100%; }

        /* å›¾ç‰‡é¢„è§ˆå¼¹çª— */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 200;
            display: flex; justify-content: center; align-items: center; padding: 20px;
            display: none; opacity: 0; transition: opacity 0.3s;
        }
        .modal.show { display: flex; opacity: 1; }
        .modal-content { background: white; padding: 10px; border-radius: 16px; max-width: 100%; max-height: 90vh; overflow-y: auto; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 10px; background: #f3f4f6; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }

    </style>
</head>
<body>

    <div class="top-bar"></div>

    <!-- 1. é¦–é¡µ -->
    <div id="page-intro" class="container active intro-content">
        <div class="icon-circle">
            <svg width="40" height="40" viewBox="0 0 256 256" fill="#ef4444"><path d="M240,102c0,70-103.79,126.66-108.21,129a8,8,0,0,1-7.58,0C119.79,228.66,16,172,16,102A62.07,62.07,0,0,1,78,40c20.65,0,38.73,8.88,50,23.89C139.27,48.88,157.35,40,178,40A62.07,62.07,0,0,1,240,102Z"></path></svg>
        </div>
        <div class="title">æ‹çˆ±å æœ‰æ¬²<br>æ·±åº¦æµ‹è¯•</div>
        <div class="subtitle">åŸºäºä¾æ‹å¿ƒç†å­¦ â€¢ 50é“ç²¾é€‰æµ‹è¯•é¢˜</div>
        
        <div class="card">
            <p>ğŸ’¡ <strong>æµ‹è¯•è¯´æ˜ï¼š</strong></p>
            <ul>
                <li>æœ¬æµ‹è¯•å…±50é¢˜ï¼Œçº¦éœ€3-5åˆ†é’Ÿã€‚</li>
                <li>è¯·æ ¹æ®ä½ çš„<strong>ç¬¬ä¸€ç›´è§‰</strong>å›ç­”ã€‚</li>
                <li>æ²¡æœ‰å¯¹é”™ä¹‹åˆ†ï¼Œè¯šå®é¢å¯¹è‡ªå·±ã€‚</li>
            </ul>
        </div>

        <button class="btn" onclick="startTest()">
            å¼€å§‹æµ‹è¯• 
            <svg width="20" height="20" viewBox="0 0 256 256" fill="white"><path d="M221.66,133.66l-72,72a8,8,0,0,1-11.32-11.32L196.69,136H40a8,8,0,0,1,0-16H196.69L138.34,61.66a8,8,0,0,1,11.32-11.32l72,72A8,8,0,0,1,221.66,133.66Z"></path></svg>
        </button>
        <div class="footer-watermark">å°çº¢ä¹¦-å¿ƒçµæ –æ¯æ ‘åŸåˆ› ä¾µæƒå¿…ç©¶</div>
    </div>

    <!-- 2. ç­”é¢˜é¡µ -->
    <div id="page-playing" class="container">
        <div style="display:flex; justify-content:space-between; font-size:12px; color:#9ca3af; margin-bottom:5px;">
            <span>è¿›åº¦</span>
            <span id="progress-text">1 / 50</span>
        </div>
        <div class="progress-bar-bg">
            <div id="progress-fill" class="progress-bar-fill"></div>
        </div>

        <div style="flex-grow:1; display:flex; flex-direction:column; justify-content:center;">
            <div>
                <span class="q-tag" id="q-number">Q1</span>
                <div class="q-text" id="q-content">é¢˜ç›®åŠ è½½ä¸­...</div>
            </div>
        </div>

        <div id="options-container">
            <!-- é€‰é¡¹ç”±JSç”Ÿæˆ -->
        </div>
        <div class="footer-watermark">å°çº¢ä¹¦-å¿ƒçµæ –æ¯æ ‘åŸåˆ› ä¾µæƒå¿…ç©¶</div>
    </div>

    <!-- 3. ç»“æœé¡µ -->
    <div id="page-result" class="container" style="padding: 20px 20px 100px 20px;">
        <div id="capture-area" style="background: white; padding-bottom: 20px;"> <!-- è¿™ä¸ªåŒºåŸŸä¼šè¢«æˆªå›¾ -->
            <div class="result-header">
                <div style="position:absolute; top:-20px; right:-20px; width:100px; height:100px; background:#ec4899; opacity:0.2; filter:blur(40px); border-radius:50%;"></div>
                <div style="position:absolute; bottom:-20px; left:-20px; width:100px; height:100px; background:#a855f7; opacity:0.2; filter:blur(40px); border-radius:50%;"></div>
                
                <div style="color:#9ca3af; font-size:12px; letter-spacing:1px; margin-bottom:5px;">æ‚¨çš„å æœ‰æ¬²æŒ‡æ•°</div>
                <div class="score-num" id="res-score">0</div>
                <div class="level-badge" id="res-level">åˆ†æä¸­...</div>
            </div>

            <div style="padding: 0 10px; margin-top: -30px; position: relative; z-index: 10;">
                <!-- ä¾æ‹ç±»å‹ -->
                <div class="analysis-card">
                    <div class="card-title">
                        <div class="icon-box" style="background:#dbeafe;"><svg width="20" height="20" fill="#2563eb" viewBox="0 0 256 256"><path d="M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80Zm-80,84a12,12,0,1,1,12-12A12,12,0,0,1,128,164Zm32-84H96V56a32,32,0,0,1,64,0Z"></path></svg></div>
                        ä¾æ‹äººæ ¼åˆ†æ
                    </div>
                    <div style="font-weight:bold; margin-bottom:5px;" id="res-attachment"></div>
                    <div class="card-text" id="res-desc"></div>
                </div>

                <!-- è¡Œä¸ºç”»åƒ -->
                <div class="analysis-card" style="animation-delay: 0.1s">
                    <div class="card-title">
                        <div class="icon-box" style="background:#f3e8ff;"><svg width="20" height="20" fill="#9333ea" viewBox="0 0 256 256"><path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.67,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM128,144a56,56,0,1,1,56-56A56.06,56.06,0,0,1,128,144Z"></path></svg></div>
                        æ½œåœ¨è¡Œä¸ºç”»åƒ
                    </div>
                    <div class="card-text" id="res-behavior"></div>
                </div>

                 <!-- æ‹çˆ±å¯¼èˆª -->
                 <div class="analysis-card" style="animation-delay: 0.2s">
                    <div class="card-title">
                        <div class="icon-box" style="background:#ffedd5;"><svg width="20" height="20" fill="#ea580c" viewBox="0 0 256 256"><path d="M236.8,188.09,149.35,36.22h0a24.76,24.76,0,0,0-42.7,0L19.2,188.09a23.51,23.51,0,0,0,0,23.72A24.35,24.35,0,0,0,40.55,224h174.9a24.35,24.35,0,0,0,21.33-12.19A23.51,23.51,0,0,0,236.8,188.09ZM120,104a8,8,0,0,1,16,0v40a8,8,0,0,1-16,0Zm8,88a12,12,0,1,1,12-12A12,12,0,0,1,128,192Z"></path></svg></div>
                        æ‹çˆ±å¯¼èˆª
                    </div>
                    <div class="card-text">
                        <p style="margin-bottom:5px;"><strong>â¤ï¸ é€‚åˆä¼´ä¾£ï¼š</strong><span id="res-partner"></span></p>
                        <p><strong>âš ï¸ é›·åŒºé¢„è­¦ï¼š</strong><span id="res-blind"></span></p>
                    </div>
                </div>

                <!-- å»ºè®® -->
                <div class="analysis-card" style="background:linear-gradient(to bottom right, #f9fafb, #fdf2f8); animation-delay: 0.3s">
                    <div class="card-title">
                        <div class="icon-box" style="background:#dcfce7;"><svg width="20" height="20" fill="#16a34a" viewBox="0 0 256 256"><path d="M222.14,33.86a8,8,0,0,0-8.49-1.89c-43.76,14.6-67,49-74.67,69.56C131.62,99.82,123.82,96,112,96A56,56,0,0,0,56,152c0,23,19.39,49.25,48.8,69.57a8,8,0,0,0,11.06-1.72L162.57,163l.71-.35c18.51-9.52,43-34.56,59.39-84.34A8,8,0,0,0,222.14,33.86ZM104.8,205.2C85.54,191.13,72,172.6,72,152a40,40,0,0,1,40-40c26.79,0,38.31,23.41,41.49,32.35l-44,48.8A8,8,0,0,0,104.8,205.2Zm66-57.08-16.12,17.91C145.45,142.14,136.65,128,118.82,128h-1.05c7-17.16,26.43-45,61.73-57.85C167.31,107,152.09,129.56,170.83,148.12Z"></path></svg></div>
                        èˆ’é€‚å…³ç³»å»ºè®®
                    </div>
                    <div class="card-text" id="res-advice"></div>
                    <div style="height:1px; background:#fce7f3; margin:10px 0;"></div>
                    <div style="font-size:12px; color:#9ca3af; font-style:italic; text-align:center;">â€œå¥åº·çš„çˆ±ä¸æ˜¯æ†ç»‘ï¼Œè€Œæ˜¯ä¸¤ä¸ªè‡ªç”±çµé­‚çš„åŒè¡Œã€‚â€</div>
                </div>

                <div class="footer-watermark">å°çº¢ä¹¦-å¿ƒçµæ –æ¯æ ‘åŸåˆ› ä¾µæƒå¿…ç©¶</div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨æŒ‰é’® (å›ºå®šæ‚¬æµ®) -->
    <div id="bottom-bar" class="bottom-bar" style="display:none;">
        <button class="btn btn-restart" onclick="restartTest()">
            é‡æ–°æµ‹è¯•
        </button>
        <button class="btn" id="save-btn" onclick="saveReport()">
            <span id="save-text">ä¿å­˜æŠ¥å‘Š</span>
        </button>
    </div>

    <!-- å›¾ç‰‡å¼¹çª— -->
    <div id="img-modal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="close-btn" onclick="closeModal()">âœ•</div>
            <img id="generated-img" style="width:100%; border-radius:12px; display:block;" src="" />
            <div style="text-align:center; padding-top:10px;">
                <div style="font-weight:bold; font-size:14px;">âœ… é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œ</div>
                <div style="font-size:12px; color:#9ca3af;">å³å¯åˆ†äº«åˆ°æœ‹å‹åœˆæˆ–å°çº¢ä¹¦</div>
            </div>
        </div>
    </div>

    <script>
        // --- é€»è¾‘å®šä¹‰åŒº (åŸç”Ÿ JS) ---
        
        const questions = [
            "å¦‚æœä½ ä¼´ä¾£çš„æ‰‹æœºå“äº†ï¼Œä½ ä¼šæœ‰ä¸€ç§å¼ºçƒˆçš„å†²åŠ¨æƒ³å»çœ‹æ˜¯è°å‘çš„æ¶ˆæ¯ã€‚",
            "ä½ ä¸å–œæ¬¢ä¼´ä¾£æœ‰å¼‚æ€§çŸ¥å·±ï¼Œå³ä½¿ä»–ä»¬è®¤è¯†çš„æ—¶é—´æ¯”ä½ è¿˜é•¿ã€‚",
            "å¦‚æœä¼´ä¾£æ²¡æœ‰ç§’å›ä½ çš„æ¶ˆæ¯ï¼Œä½ ä¼šå¼€å§‹èƒ¡æ€ä¹±æƒ³ã€‚",
            "ä½ å¸Œæœ›çŸ¥é“ä¼´ä¾£æ¯ä¸€åˆ†é’Ÿçš„è¡Œè¸ªã€‚",
            "ä½ ç»å¸¸ç¿»çœ‹ä¼´ä¾£çš„ç¤¾äº¤åª’ä½“åŠ¨æ€ï¼ŒæŸ¥çœ‹ç‚¹èµå’Œè¯„è®ºçš„äººæ˜¯è°ã€‚",
            "ä½ è®¤ä¸ºæ‹çˆ±ä¸­çš„äººåº”è¯¥æ²¡æœ‰ä»»ä½•ç§˜å¯†ã€‚",
            "å¦‚æœä¼´ä¾£æƒ³ç‹¬è‡ªå»æ—…è¡Œï¼Œä½ ä¼šæ„Ÿåˆ°éå¸¸ä¸å®‰æˆ–ç”Ÿæ°”ã€‚",
            "ä½ å¸¸å¸¸æ‹…å¿ƒä¼´ä¾£ä¼šé‡åˆ°æ¯”ä½ æ›´å¥½çš„äººè€Œç¦»å¼€ä½ ã€‚",
            "ä½ ä¸å–œæ¬¢ä¼´ä¾£å¤¸èµå…¶ä»–çš„å¼‚æ€§ã€‚",
            "ä½ å¸Œæœ›ä¼´ä¾£æŠŠæ‰€æœ‰çš„ç©ºé—²æ—¶é—´éƒ½èŠ±åœ¨ä½ èº«ä¸Šã€‚",
            "å¦‚æœä¼´ä¾£å› ä¸ºå·¥ä½œå¿™ç¢Œå¿½ç•¥äº†ä½ ï¼Œä½ ä¼šè§‰å¾—ä»–ä¸çˆ±ä½ äº†ã€‚",
            "ä½ æ›¾ç»å·å·æŸ¥çœ‹è¿‡ä¼´ä¾£çš„æ‰‹æœºæˆ–èŠå¤©è®°å½•ã€‚",
            "ä½ å¾ˆéš¾æ¥å—ä¼´ä¾£æœ‰ä½ ä¸çŸ¥é“çš„è¿‡å»ã€‚",
            "å½“ä¼´ä¾£å’Œæœ‹å‹èšä¼šæ—¶ï¼Œä½ ä¼šè¦æ±‚ä»–/å¥¹éšæ—¶æ‹ç…§æŠ¥å¤‡ã€‚",
            "ä½ è®¤ä¸ºä¼´ä¾£ç©¿ä»€ä¹ˆè¡£æœå‡ºé—¨åº”è¯¥ç»è¿‡ä½ çš„åŒæ„ã€‚",
            "ä½ ç»å¸¸è¯¢é—®ä¼´ä¾£â€œä½ çˆ±ä¸çˆ±æˆ‘â€æ¥è·å¾—ç¡®è®¤ã€‚",
            "å¦‚æœä¼´ä¾£å¯¹ä½ çš„æ€åº¦ç¨å¾®å†·æ·¡ä¸€ç‚¹ï¼Œä½ å°±ä¼šé™·å…¥ç„¦è™‘ã€‚",
            "ä½ ä¸å–œæ¬¢ä¼´ä¾£åœ¨æ²¡æœ‰ä½ çš„æƒ…å†µä¸‹ç©å¾—å¾ˆå¼€å¿ƒã€‚",
            "ä½ è§‰å¾—ä¼´ä¾£çš„ç¤¾äº¤åœˆå­å¤ªå¹¿æ˜¯ä¸€ç§å¨èƒã€‚",
            "ä½ å¸Œæœ›æˆä¸ºä¼´ä¾£ç”Ÿå‘½ä¸­å”¯ä¸€é‡è¦çš„äººï¼Œç”šè‡³è¶…è¿‡äº²äººã€‚",
            "çœ‹åˆ°ä¼´ä¾£å’Œåˆ«äººèŠå¾—å¾ˆæŠ•æœºï¼Œä½ ä¼šæ„Ÿåˆ°å¿ƒé‡Œä¸èˆ’æœã€‚",
            "ä½ ä¼šå› ä¸ºä¼´ä¾£å›å¤åˆ«äººçš„æ¶ˆæ¯æ¯”å›å¤ä½ çš„é•¿è€Œåƒé†‹ã€‚",
            "ä½ å€¾å‘äºå¸®ä¼´ä¾£åšå†³å®šï¼Œå› ä¸ºä½ è§‰å¾—è¿™æ ·å¯¹ä»–/å¥¹å¥½ã€‚",
            "å¦‚æœä¼´ä¾£æ›´æ”¹äº†æ‰‹æœºå¯†ç ï¼Œä½ ä¼šè§‰å¾—ä»–åœ¨éšç’ä»€ä¹ˆã€‚",
            "ä½ ä¸å–œæ¬¢ä¼´ä¾£æåŠå‰ä»»çš„ä»»ä½•äº‹æƒ…ï¼Œå³ä½¿æ˜¯å®¢è§‚è¯„ä»·ã€‚",
            "ä½ è®¤ä¸ºâ€œæŠ¥å¤‡â€æ˜¯æ‹çˆ±ä¸­æœ€åŸºæœ¬çš„ä¹‰åŠ¡ï¼Œå¿…é¡»äº‹æ— å·¨ç»†ã€‚",
            "ä½ æœ‰æ—¶ä¼šæ•…æ„è®©ä¼´ä¾£å«‰å¦’ï¼Œä»¥æµ‹è¯•ä»–å¯¹ä½ çš„åœ¨ä¹ç¨‹åº¦ã€‚",
            "ä½ å¾ˆéš¾ä¿¡ä»»ä¼´ä¾£èº«è¾¹çš„å•èº«å¼‚æ€§åŒäº‹ã€‚",
            "å¦‚æœä¼´ä¾£æƒ³æ‹¥æœ‰ç‹¬å¤„çš„ç©ºé—´ï¼Œä½ ä¼šè§‰å¾—è¿™æ˜¯ä¸€ç§ç–è¿œã€‚",
            "ä½ ä¼šé™åˆ¶ä¼´ä¾£çš„æŸäº›çˆ±å¥½ï¼Œå› ä¸ºé‚£ä¼šå ç”¨ä½ ä»¬ç›¸å¤„çš„æ—¶é—´ã€‚",
            "ä½ ç»å¸¸æ‹¿è‡ªå·±å’Œä¼´ä¾£èº«è¾¹çš„äººåšæ¯”è¾ƒã€‚",
            "ä½ è®¤ä¸ºä¼´ä¾£åº”è¯¥æ— æ¡ä»¶ç«™åœ¨ä½ è¿™è¾¹ï¼Œå³ä½¿ä½ æ˜¯é”™çš„ã€‚",
            "å¦‚æœä¼´ä¾£ä¸æŠŠåˆç…§å‘æœ‹å‹åœˆï¼Œä½ ä¼šéå¸¸ä»‹æ„ã€‚",
            "ä½ å¾ˆéš¾å¿å—ä¼´ä¾£æœ‰ä»»ä½•äº‹æƒ…ç’ç€ä½ ã€‚",
            "ä½ ä¼šåœ¨è„‘æµ·ä¸­é¢„æ¼”ä¼´ä¾£èƒŒå›ä½ çš„åœºæ™¯ï¼Œå¹¶å› æ­¤æ„Ÿåˆ°éš¾è¿‡ã€‚",
            "ä½ è§‰å¾—ä¸ºäº†çˆ±æƒ…ï¼Œç‰ºç‰²ä¸€éƒ¨åˆ†ä¸ªäººè‡ªç”±æ˜¯ç†æ‰€åº”å½“çš„ã€‚",
            "ä½ æ›¾è¦æ±‚ä¼´ä¾£åˆ é™¤æŸäº›ä½ ä¸å–œæ¬¢çš„è”ç³»äººã€‚",
            "ä½ å¯¹ä¼´ä¾£çš„è¡Œè¸ªäº†è§£å¾—è¶Šè¯¦ç»†ï¼Œä½ å°±è¶Šæœ‰å®‰å…¨æ„Ÿã€‚",
            "ä½ è®¤ä¸ºä¸¤ä¸ªäººåœ¨ä¸€èµ·å°±åº”è¯¥å…±äº«è´¦å·å¯†ç ã€‚",
            "ä½ ä¼šå› ä¸ºä¼´ä¾£æ²¡æœ‰æ³¨æ„åˆ°ä½ çš„æ–°å‘å‹æˆ–è¡£æœè€Œç”Ÿæ°”ã€‚",
            "ä½ è§‰å¾—ä¼´ä¾£å¦‚æœä¸å›å¤æ¶ˆæ¯ï¼Œå°±ä¸åº”è¯¥å‘æœ‹å‹åœˆã€‚",
            "ä½ å¾ˆéš¾æ¥å—ä¼´ä¾£åœ¨åµæ¶åé€‰æ‹©å›é¿æˆ–å†·æˆ˜ã€‚",
            "ä½ ä¼šé€šè¿‡ä¼´ä¾£çš„æ¶ˆè´¹è®°å½•æ¥æ¨æ–­ä»–çš„è¡Œè¸ªã€‚",
            "ä½ è®¤ä¸ºä¼´ä¾£ä¸ä»…è¦æ˜¯æ‹äººï¼Œè¿˜è¦æ˜¯ä½ æœ€å¥½çš„æœ‹å‹å’Œå¿ƒç†å’¨è¯¢å¸ˆã€‚",
            "å¦‚æœä¼´ä¾£ç§°èµè·¯äººå¥½çœ‹ï¼Œä½ ä¼šç«‹åˆ»æ„Ÿåˆ°ä¸æ‚¦ã€‚",
            "ä½ ç»å¸¸æ‹…å¿ƒè¿™æ®µå…³ç³»ä¼šçªç„¶ç»“æŸã€‚",
            "ä½ è§‰å¾—ä½ çš„æƒ…ç»ªå®Œå…¨å–å†³äºä¼´ä¾£å¯¹ä½ çš„æ€åº¦ã€‚",
            "ä½ ä¼šå› ä¸ºä¼´ä¾£æ²¡æœ‰åœ¨èŠ‚æ—¥é€å‡ºç¬¦åˆé¢„æœŸçš„ç¤¼ç‰©è€Œè´¨ç–‘æ„Ÿæƒ…ã€‚",
            "ä½ å¸Œæœ›ä¼´ä¾£çš„æœªæ¥è§„åˆ’é‡Œå…¨éƒ¨éƒ½æ˜¯å…³äºä½ çš„ã€‚",
            "ä¸ºäº†ç•™ä½å¯¹æ–¹ï¼Œä½ æ„¿æ„åšä»»ä½•æ”¹å˜ï¼Œç”šè‡³å¤±å»è‡ªæˆ‘ã€‚"
        ];

        let currentIdx = 0;
        let totalScore = 0;
        
        // é€‰é¡¹é…ç½®
        const options = [
            { t: "éå¸¸ç¬¦åˆ", s: 5, c: "opt-5" },
            { t: "æ¯”è¾ƒç¬¦åˆ", s: 4, c: "opt-4" },
            { t: "ä¸€èˆ¬ / ä¸ç¡®å®š", s: 3, c: "opt-3" },
            { t: "æ¯”è¾ƒä¸ç¬¦åˆ", s: 2, c: "opt-2" },
            { t: "å®Œå…¨ä¸ç¬¦åˆ", s: 1, c: "opt-1" }
        ];

        // é¡µé¢åˆ‡æ¢
        function showPage(pageId) {
            document.querySelectorAll('.container').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // åº•éƒ¨æ æ§åˆ¶
            if(pageId === 'page-result') {
                document.getElementById('bottom-bar').style.display = 'flex';
            } else {
                document.getElementById('bottom-bar').style.display = 'none';
            }
            window.scrollTo(0,0);
        }

        function startTest() {
            currentIdx = 0;
            totalScore = 0;
            renderQuestion();
            showPage('page-playing');
        }

        function renderQuestion() {
            document.getElementById('progress-text').innerText = (currentIdx + 1) + " / " + questions.length;
            document.getElementById('progress-fill').style.width = ((currentIdx + 1) / questions.length * 100) + "%";
            document.getElementById('q-number').innerText = "Q" + (currentIdx + 1);
            document.getElementById('q-content').innerText = questions[currentIdx];

            const optsDiv = document.getElementById('options-container');
            optsDiv.innerHTML = '';
            
            options.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-btn ' + opt.c;
                btn.innerHTML = `<span>${opt.t}</span><span style="width:16px;height:16px;border:1px solid currentColor;border-radius:50%;opacity:0.3"></span>`;
                btn.onclick = () => handleAnswer(opt.s);
                optsDiv.appendChild(btn);
            });
        }

        function handleAnswer(score) {
            totalScore += score;
            if (currentIdx < questions.length - 1) {
                currentIdx++;
                // ç®€å•çš„æ·¡å‡ºæ·¡å…¥æ•ˆæœ
                const content = document.getElementById('q-content');
                content.style.opacity = 0;
                setTimeout(() => {
                    renderQuestion();
                    content.style.opacity = 1;
                }, 200);
            } else {
                calculateAndShowResult();
            }
        }

        function calculateAndShowResult() {
            const finalScore = Math.round((totalScore / (questions.length * 5)) * 100);
            const res = analyze(finalScore);
            
            document.getElementById('res-score').innerText = finalScore;
            document.getElementById('res-level').innerText = res.level;
            // å¤„ç†é¢œè‰²
            document.getElementById('res-level').style.background = res.bg;
            document.getElementById('res-level').style.color = res.fg;
            
            document.getElementById('res-attachment').innerText = res.attachment;
            document.getElementById('res-desc').innerText = res.description;
            document.getElementById('res-behavior').innerText = res.behavior;
            document.getElementById('res-partner').innerText = res.partner_suggestion;
            document.getElementById('res-blind').innerText = res.blind_spot;
            document.getElementById('res-advice').innerText = res.advice;

            showPage('page-result');
        }

        function analyze(score) {
            if (score <= 25) {
                return {
                    level: "ä½›ç³»/ç–ç¦»å‹", bg: "#dcfce7", fg: "#15803d",
                    attachment: "å›é¿å‹ä¾æ‹ (Avoidant)",
                    description: "ä½ çš„å æœ‰æ¬²éå¸¸ä½ï¼Œç”šè‡³å¯èƒ½æ˜¾å¾—æœ‰äº›ç–ç¦»ã€‚ä½ éå¸¸çœ‹é‡ä¸ªäººç©ºé—´å’Œç‹¬ç«‹æ€§ï¼Œä¸ä»…ç»™è‡ªå·±ï¼Œä¹Ÿç»™ä¼´ä¾£æå¤§çš„è‡ªç”±ã€‚",
                    behavior: "å‡ ä¹ä»ä¸æŸ¥å²—ï¼Œä¹Ÿä¸ä»‹æ„ä¼´ä¾£æœ‰å¼‚æ€§æœ‹å‹ã€‚å½“ä¼´ä¾£è¡¨ç°å‡ºå¼ºçƒˆçš„ä¾èµ–æ—¶ï¼Œå¯èƒ½ä¼šä¸‹æ„è¯†åœ°æƒ³é€ƒç¦»ã€‚",
                    partner_suggestion: "ç‹¬ç«‹ã€æœ‰è‡ªå·±ç”Ÿæ´»é‡å¿ƒçš„ä¼´ä¾£ï¼ˆå¦‚å®‰å…¨å‹ï¼‰ã€‚",
                    blind_spot: "å®¹æ˜“å› è¾¹ç•Œæ„Ÿè¿‡å¼ºè¢«è¯¯è§£ä¸ºâ€œå†·æš´åŠ›â€æˆ–â€œä¸çˆ±äº†â€ã€‚",
                    advice: "é€‚åº¦çš„å æœ‰æ¬²æ˜¯â€œåœ¨ä¹â€çš„è¡¨ç°ï¼Œå°è¯•å¤šå‘ä¼´ä¾£è¡¨è¾¾æƒ…æ„Ÿéœ€æ±‚ã€‚"
                };
            } else if (score <= 50) {
                return {
                    level: "å®‰å…¨/å¹³è¡¡å‹", bg: "#dbeafe", fg: "#1d4ed8",
                    attachment: "å®‰å…¨å‹ä¾æ‹ (Secure)",
                    description: "ä½ çš„å æœ‰æ¬²å¤„äºéå¸¸å¥åº·çš„æ°´å¹³ã€‚ä½ ä¿¡ä»»ä¼´ä¾£ï¼Œä¹Ÿè‡ªä¿¡äºè¿™æ®µå…³ç³»ï¼Œæ‡‚å¾—åœ¨äº²å¯†å’Œç‹¬ç«‹ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚",
                    behavior: "å¶å°”åƒé†‹æ˜¯æƒ…è¶£è€Œéæ§åˆ¶ã€‚ä¸éœ€è¦é€šè¿‡æŸ¥æ‰‹æœºè·å¾—å®‰å…¨æ„Ÿï¼Œä¼´ä¾£å¤±è”æ—¶ä¹Ÿèƒ½å®‰ç¨³åšè‡ªå·±çš„äº‹ã€‚",
                    partner_suggestion: "ä½ æ˜¯ä¸‡èƒ½é€‚é…è€…ï¼Œä½†æ‰¾åŒæ ·çš„å®‰å…¨å‹ä¼´ä¾£ä¼šè®©ç”Ÿæ´»æœ€è½»æ¾ã€‚",
                    blind_spot: "å¯èƒ½å› è¿‡äºç†æ™ºè€Œå¿½ç•¥ä¼´ä¾£å½“ä¸‹çš„æƒ…ç»ªæ³¢åŠ¨ã€‚",
                    advice: "ä¿æŒç°çŠ¶ï¼Œç»§ç»­ç”¨åŒ…å®¹å’Œä¿¡ä»»æ»‹å…»å…³ç³»ã€‚"
                };
            } else if (score <= 75) {
                return {
                    level: "ç„¦è™‘/ä¾æ‹å‹", bg: "#fef9c3", fg: "#b45309",
                    attachment: "ç„¦è™‘å‹ä¾æ‹ (Anxious)",
                    description: "ä½ æœ‰è¾ƒå¼ºçš„å æœ‰æ¬²ï¼Œæºäºå¯¹å…³ç³»çš„é‡è§†å’Œä¸å®‰å…¨æ„Ÿã€‚å®¹æ˜“èƒ¡æ€ä¹±æƒ³ï¼Œéœ€è¦ä¼´ä¾£é¢‘ç¹çš„ç¡®è®¤ã€‚",
                    behavior: "å¯¹å›å¤é€Ÿåº¦ã€è¯­æ°”éå¸¸æ•æ„Ÿã€‚åµæ¶æ—¶å€¾å‘äºè¿½ç€æŠŠè¯è¯´æ¸…æ¥šï¼Œæ— æ³•å¿å—å†·å¤„ç†ã€‚",
                    partner_suggestion: "æƒ…ç»ªç¨³å®šã€äº‹äº‹æœ‰å›åº”çš„ä¼´ä¾£ã€‚é¿å…å›é¿å‹ã€‚",
                    blind_spot: "å®¹æ˜“æ··æ·†â€œçˆ±â€å’Œâ€œèåˆâ€ï¼Œè¯•å›¾æ¶ˆç­ç•Œé™æ¥è·å¾—å®‰å…¨æ„Ÿã€‚",
                    advice: "å»ºç«‹â€œè‡ªæˆ‘å®‰å…¨æ„Ÿâ€ï¼Œå‡å°‘å¯¹ä¼´ä¾£çš„æƒ…ç»ªä¾èµ–ã€‚"
                };
            } else {
                return {
                    level: "æè‡´/æŒæ§å‹", bg: "#fee2e2", fg: "#b91c1c",
                    attachment: "ææƒ§/ç—´è¿·å‹ (Disorganized)",
                    description: "å æœ‰æ¬²éå¸¸å¼ºï¼Œå¯èƒ½å·²å½±å“å…³ç³»å¥åº·ã€‚æ¸´æœ›å®Œå…¨æŒæ§ä¼´ä¾£çš„è¡Œè¸ªï¼Œä»»ä½•é£å¹è‰åŠ¨éƒ½ä¼šå¼•å‘è­¦è§‰ã€‚",
                    behavior: "å¯èƒ½é™åˆ¶ä¼´ä¾£ç¤¾äº¤ï¼Œè¦æ±‚ç§’å›ï¼Œå¾ˆéš¾ä¿¡ä»»å¯¹æ–¹ã€‚çˆ±åƒæ˜¯ä¸€åœºå¿…é¡»èµ¢çš„æˆ˜äº‰ã€‚",
                    partner_suggestion: "åŒ…å®¹æ€§æå¼ºä¸”è¾¹ç•Œæ„Ÿæ¸…æ™°æˆç†Ÿçš„ä¼´ä¾£ã€‚",
                    blind_spot: "é«˜å‹æ§åˆ¶ææ˜“å¯¼è‡´å…³ç³»ç ´è£‚ï¼Œçˆ±å˜æˆäº†æ·é”ã€‚",
                    advice: "å°è¯•â€œè¯¾é¢˜åˆ†ç¦»â€ï¼Œæ„è¯†åˆ°ä¼´ä¾£æ˜¯ç‹¬ç«‹ä¸ªä½“ã€‚å¿…è¦æ—¶å¯»æ±‚å¿ƒç†å’¨è¯¢ã€‚"
                };
            }
        }

        function restartTest() {
            showPage('page-intro');
        }

        // ç”Ÿæˆå›¾ç‰‡é€»è¾‘
        function saveReport() {
            const btn = document.getElementById('save-text');
            const originalText = btn.innerText;
            btn.innerText = "ç”Ÿæˆä¸­...";
            
            const area = document.getElementById('capture-area');
            
            // ä½¿ç”¨ html2canvas
            if(typeof html2canvas !== 'undefined') {
                html2canvas(area, {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: "#ffffff"
                }).then(canvas => {
                    const imgData = canvas.toDataURL("image/png");
                    document.getElementById('generated-img').src = imgData;
                    document.getElementById('img-modal').classList.add('show');
                    btn.innerText = originalText;
                }).catch(err => {
                    alert("ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç›´æ¥æ‰‹æœºæˆªå±ä¿å­˜");
                    btn.innerText = originalText;
                });
            } else {
                alert("ç”Ÿæˆå›¾ç‰‡ç»„ä»¶åŠ è½½å¤±è´¥ï¼ˆç½‘ç»œé—®é¢˜ï¼‰ï¼Œè¯·ç›´æ¥æ‰‹æœºæˆªå±");
                btn.innerText = originalText;
            }
        }

        function closeModal() {
            document.getElementById('img-modal').classList.remove('show');
        }
    </script>
</body>
</html>
