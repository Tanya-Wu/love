<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å‹æƒ…å æœ‰æ¬²æ·±åº¦æµ‹è¯•</title>
    
    <!-- å”¯ä¸€çš„ä¸€ä¸ªå¤–éƒ¨é“¾æ¥ï¼Œåªç”¨äºç”Ÿæˆå›¾ç‰‡åŠŸèƒ½ï¼Œä½¿ç”¨å›½å†…æœ€å¿«çš„å­—èŠ‚è·³åŠ¨æº -->
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* --- 1. æ ·å¼å®šä¹‰åŒº --- */
        :root {
            --primary: #ec4899;
            --primary-light: #fce7f3;
            --bg-color: #fdf4ff; /* æ›´æ¸©æš–çš„æ·¡ç²‰ç´«èƒŒæ™¯ */
            --card-bg: #ffffff;
            --text-main: #374151;
            --text-sub: #6b7280;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* é¡¶éƒ¨è¿›åº¦æ¡å®¹å™¨ */
        .top-bar { height: 6px; background: #e5e7eb; width: 100%; position: fixed; top: 0; left: 0; z-index: 50; }
        .top-bar-fill { height: 100%; background: linear-gradient(90deg, #f472b6, #a855f7); width: 0%; transition: width 0.3s; }

        /* é€šç”¨å®¹å™¨ */
        .container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 24px 20px;
            max-width: 480px;
            margin: 0 auto;
            width: 100%;
            display: none; 
            animation: fadeIn 0.4s ease-out;
            padding-top: 30px; /* é¿å¼€é¡¶éƒ¨æ¡ */
        }
        
        .container.active { display: flex; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        /* --- é¦–é¡µæ ·å¼ --- */
        .intro-content { text-align: center; justify-content: center; min-height: 90vh; }
        
        /* ä¿®å¤å›¾æ ‡æ¯”ä¾‹é—®é¢˜ï¼šä½¿ç”¨å›ºå®šå®½é«˜å’Œ flex å±…ä¸­ */
        .icon-circle { 
            width: 80px; 
            height: 80px; 
            background: white; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            margin: 0 auto 24px auto; 
            animation: bounce 2s infinite; 
            box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.3);
            flex-shrink: 0; /* é˜²æ­¢è¢«æŒ¤å‹ */
        }
        
        .title { font-size: 32px; font-weight: 800; margin-bottom: 12px; line-height: 1.2; color: #111827; letter-spacing: -0.5px; }
        .subtitle { color: var(--text-sub); font-size: 15px; margin-bottom: 40px; }
        
        .card { 
            background: var(--card-bg); 
            padding: 24px; 
            border-radius: 20px; 
            text-align: left; 
            font-size: 15px; 
            line-height: 1.6;
            color: var(--text-main); 
            margin-bottom: 30px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.03); 
            border: 1px solid rgba(255,255,255,0.8);
        }
        .card ul { padding-left: 18px; margin: 10px 0 0 0; color: var(--text-sub); }
        .card li { margin-bottom: 6px; }

        /* --- æŒ‰é’®æ ·å¼ --- */
        .btn {
            width: 100%;
            padding: 18px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 700;
            color: white;
            background: linear-gradient(135deg, #ec4899, #be185d);
            border: none;
            box-shadow: 0 8px 20px -5px rgba(236, 72, 153, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        .btn::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(255,255,255,0.2), transparent);
            opacity: 0; transition: opacity 0.2s;
        }
        .btn:active { transform: scale(0.98); box-shadow: 0 4px 10px -2px rgba(236, 72, 153, 0.4); }
        .btn:active::after { opacity: 1; }
        .btn-restart { background: white; color: var(--text-main); border: 1px solid #e5e7eb; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-right: 12px; }
        
        /* --- ç­”é¢˜é¡µæ ·å¼ --- */
        .progress-text { font-size: 13px; font-weight: 600; color: #9ca3af; margin-bottom: 40px; text-align: center; letter-spacing: 1px; }
        
        .q-card {
            background: white; border-radius: 24px; padding: 30px 24px;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.05);
            text-align: center; margin-bottom: 24px;
            border: 1px solid rgba(255,255,255,0.6);
        }
        .q-tag { 
            background: #fdf2f8; color: #db2777; 
            font-size: 13px; font-weight: 800; 
            padding: 6px 14px; border-radius: 12px; 
            display: inline-block; margin-bottom: 20px; 
        }
        .q-text { font-size: 20px; font-weight: 700; line-height: 1.5; color: #1f2937; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        
        .option-btn {
            width: 100%; padding: 18px 24px; margin-bottom: 12px;
            background: rgba(255,255,255,0.6); 
            border: 2px solid white; 
            border-radius: 16px;
            text-align: left; font-size: 16px; font-weight: 600; color: #4b5563;
            display: flex; justify-content: space-between; align-items: center;
            transition: all 0.2s; cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.02);
        }
        .option-btn:active { transform: scale(0.98); background: white; border-color: var(--primary); color: var(--primary); }

        /* --- ç»“æœé¡µæ ·å¼ (é‡è®¾è®¡) --- */
        .result-container {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.1);
            position: relative;
            margin-bottom: 20px;
        }

        /* å¤´éƒ¨è®¾è®¡ */
        .res-header {
            background: linear-gradient(135deg, #fdf4ff 0%, #fce7f3 100%);
            padding: 40px 20px 30px 20px;
            text-align: center;
            position: relative;
        }
        /* è£…é¥°èƒŒæ™¯åœ† */
        .deco-circle { position: absolute; border-radius: 50%; filter: blur(40px); opacity: 0.6; }
        .dc-1 { width: 100px; height: 100px; background: #f9a8d4; top: -20px; right: -20px; }
        .dc-2 { width: 80px; height: 80px; background: #c4b5fd; bottom: 10px; left: -20px; }

        .res-score-box { position: relative; z-index: 10; }
        .res-subtitle { font-size: 13px; font-weight: 600; color: #9ca3af; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .res-score { 
            font-size: 80px; 
            font-weight: 900; 
            line-height: 1;
            background: linear-gradient(to right, #db2777, #9333ea); 
            -webkit-background-clip: text; 
            color: transparent; 
            margin-bottom: 10px;
        }
        .res-level-pill {
            display: inline-block;
            background: white;
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(236, 72, 153, 0.15);
            color: #374151; /* é»˜è®¤è‰²ï¼Œä¼šJSè¦†ç›– */
        }

        /* å†…å®¹åŒºè®¾è®¡ */
        .res-body { padding: 30px 24px 40px 24px; }

        .info-section { margin-bottom: 30px; }
        .info-title { 
            font-size: 15px; font-weight: 700; color: #111827; 
            display: flex; align-items: center; gap: 8px; margin-bottom: 12px; 
        }
        .info-icon { 
            width: 24px; height: 24px; border-radius: 6px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 14px;
        }
        
        .info-main-text { font-size: 18px; font-weight: 700; color: #1f2937; margin-bottom: 8px; }
        .info-desc { font-size: 14px; color: #4b5563; line-height: 1.7; text-align: justify; }

        .advice-box {
            background: #f0fdf4; border-radius: 16px; padding: 20px;
            border: 1px solid #dcfce7;
        }
        .advice-quote { 
            margin-top: 15px; padding-top: 15px; border-top: 1px dashed #bbf7d0; 
            font-size: 12px; color: #15803d; font-style: italic; text-align: center; 
        }

        .watermark { text-align: center; color: #d1d5db; font-size: 11px; font-weight: 500; letter-spacing: 0.5px; margin-top: 20px; }

        /* åº•éƒ¨æµ®åŠ¨æ  */
        .bottom-action-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(12px);
            padding: 16px 20px 30px 20px;
            border-top: 1px solid rgba(0,0,0,0.05);
            display: flex; z-index: 100;
        }

        /* å›¾ç‰‡å¼¹çª— */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 200;
            display: none; justify-content: center; align-items: center; padding: 20px;
            opacity: 0; transition: opacity 0.3s;
        }
        .modal.show { display: flex; opacity: 1; }
        .modal-content { background: transparent; max-width: 100%; max-height: 90vh; overflow-y: auto; text-align: center; }
        .close-btn { 
            position: absolute; top: 20px; right: 20px; 
            width: 40px; height: 40px; background: rgba(255,255,255,0.2); 
            border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; 
            font-size: 20px; cursor: pointer; backdrop-filter: blur(5px);
        }
    </style>
</head>
<body>

    <div class="top-bar"><div id="top-progress" class="top-bar-fill"></div></div>

    <!-- 1. é¦–é¡µ -->
    <div id="page-intro" class="container active intro-content">
        <div class="icon-circle">
            <svg width="40" height="40" viewBox="0 0 256 256" fill="#ec4899"><path d="M236.46,173.1,208.27,118A32,32,0,1,0,152,112a32.09,32.09,0,0,0,1.52,9.6L128,144.4l-25.52-22.8A32.09,32.09,0,0,0,104,112a32,32,0,1,0-56.27,6L19.54,173.1A16,16,0,0,0,33.81,198H222.19A16,16,0,0,0,236.46,173.1ZM72,96a16,16,0,1,1-16,16A16,16,0,0,1,72,96ZM34.62,182l25-48.88a31.9,31.9,0,0,0,24.78,0l25,48.88Zm186.76,0-25-48.88a31.9,31.9,0,0,0,24.78,0l25,48.88ZM184,128a16,16,0,1,1,16-16A16,16,0,0,1,184,128Z"></path></svg>
        </div>
        <div class="title">å‹æƒ…å æœ‰æ¬²<br>æ·±åº¦æµ‹è¯•</div>
        <div class="subtitle">åŸºäºäººé™…ä¾æ‹å¿ƒç†å­¦ â€¢ 50é“ç²¾é€‰æµ‹è¯•é¢˜</div>
        
        <div class="card">
            <p style="font-weight:700; margin-bottom:10px; font-size:16px;">ğŸ’¡ æµ‹è¯•è¯´æ˜ï¼š</p>
            <ul>
                <li>è¯·è”æƒ³ä¸€ä½ä½ <strong>â€œæœ€å¥½çš„æœ‹å‹â€</strong></li>
                <li>å…±50é¢˜ï¼Œçº¦éœ€3-5åˆ†é’Ÿ</li>
                <li>è¯·å‡­ç¬¬ä¸€ç›´è§‰å›ç­”</li>
            </ul>
        </div>

        <button class="btn" onclick="startTest()">
            å¼€å§‹æµ‹è¯• 
            <svg width="20" height="20" viewBox="0 0 256 256" fill="white"><path d="M181.66,133.66l-80,80A8,8,0,0,1,88,208V48a8,8,0,0,1,13.66-5.66l80,80A8,8,0,0,1,181.66,133.66Z"></path></svg>
        </button>
        <div class="watermark" style="color:#9ca3af; margin-top:30px;">å°çº¢ä¹¦-å¿ƒçµæ –æ¯æ ‘åŸåˆ› ä¾µæƒå¿…ç©¶</div>
    </div>

    <!-- 2. ç­”é¢˜é¡µ -->
    <div id="page-playing" class="container" style="justify-content: center;">
        <div class="progress-text"><span id="curr-q">1</span> / 50</div>

        <div class="q-card">
            <span class="q-tag" id="q-number">Q1</span>
            <div class="q-text" id="q-content">é¢˜ç›®åŠ è½½ä¸­...</div>
        </div>

        <div id="options-container" style="width: 100%;">
            <!-- é€‰é¡¹ç”±JSç”Ÿæˆ -->
        </div>
    </div>

    <!-- 3. ç»“æœé¡µ (UIé‡åš) -->
    <div id="page-result" class="container" style="padding-bottom: 120px;">
        <!-- æˆªå›¾åŒºåŸŸå¼€å§‹ -->
        <div id="capture-area" class="result-container">
            <!-- å¤´éƒ¨ -->
            <div class="res-header">
                <div class="deco-circle dc-1"></div>
                <div class="deco-circle dc-2"></div>
                
                <div class="res-score-box">
                    <div class="res-subtitle">æ‚¨çš„å‹æƒ…å æœ‰æ¬²æŒ‡æ•°</div>
                    <div class="res-score" id="res-score">0</div>
                    <div class="res-level-pill" id="res-level">åˆ†æä¸­...</div>
                </div>
            </div>

            <!-- å†…å®¹ -->
            <div class="res-body">
                <!-- ä¾æ‹ç±»å‹ -->
                <div class="info-section">
                    <div class="info-title">
                        <div class="info-icon" style="background:#dbeafe; color:#2563eb;">âœ¦</div>
                        å‹æƒ…è§‚ç”»åƒ
                    </div>
                    <div class="info-main-text" id="res-attachment"></div>
                    <div class="info-desc" id="res-desc"></div>
                </div>

                <div style="width:100%; height:1px; background:#f3f4f6; margin: 25px 0;"></div>

                <!-- è¡Œä¸ºç‰¹å¾ -->
                <div class="info-section">
                    <div class="info-title">
                        <div class="info-icon" style="background:#f3e8ff; color:#9333ea;">â˜…</div>
                        ç›¸å¤„æ¨¡å¼ç‰¹å¾
                    </div>
                    <div class="info-desc" id="res-behavior"></div>
                </div>

                <!-- é¿å‘æŒ‡å— -->
                <div class="info-section">
                    <div class="info-title">
                        <div class="info-icon" style="background:#ffedd5; color:#ea580c;">âš ï¸</div>
                        å‹æƒ…é¿å‘æŒ‡å—
                    </div>
                    <div class="info-desc" style="background:#fff7ed; padding:15px; border-radius:12px; border-left:4px solid #fdba74;">
                        <div style="margin-bottom:8px;"><strong>ğŸ¤ é€‚åˆçš„æœ‹å‹ï¼š</strong><span id="res-partner"></span></div>
                        <div><strong>ğŸ’£ å¿ƒç†é›·åŒºï¼š</strong><span id="res-blind"></span></div>
                    </div>
                </div>

                <!-- å»ºè®® -->
                <div class="advice-box">
                    <div class="info-title" style="margin-bottom:8px;">
                        <div class="info-icon" style="background:#dcfce7; color:#16a34a;">â™¥</div>
                        å»ºè®®
                    </div>
                    <div class="info-desc" id="res-advice" style="color:#374151;"></div>
                    <div class="advice-quote">â€œçœŸæ­£çš„å‹è°Šæ˜¯ï¼šå³ä½¿ä¸å¸¸è”ç³»ï¼Œè§é¢æ—¶ä¾ç„¶å¦‚æ•…ã€‚â€</div>
                </div>

                <div class="watermark">å°çº¢ä¹¦-å¿ƒçµæ –æ¯æ ‘ åŸåˆ›</div>
            </div>
        </div>
        <!-- æˆªå›¾åŒºåŸŸç»“æŸ -->
    </div>

    <!-- åº•éƒ¨æ“ä½œæ  -->
    <div id="bottom-bar" class="bottom-action-bar" style="display:none;">
        <button class="btn btn-restart" onclick="restartTest()">é‡æµ‹</button>
        <button class="btn" id="save-btn" onclick="saveReport()">
            ä¿å­˜æŠ¥å‘Šå¡ç‰‡
            <svg width="20" height="20" viewBox="0 0 256 256" fill="white"><path d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm-4,160H44V56H212ZM160,88a12,12,0,1,1-12,12A12,12,0,0,1,160,88Z"></path></svg>
        </button>
    </div>

    <!-- å›¾ç‰‡å¼¹çª— -->
    <div id="img-modal" class="modal" onclick="closeModal()">
        <div class="close-btn" onclick="closeModal()">âœ•</div>
        <div class="modal-content" onclick="event.stopPropagation()">
            <img id="generated-img" style="width:100%; border-radius:12px; display:block; box-shadow: 0 10px 40px rgba(0,0,0,0.5);" src="" />
            <div style="margin-top:15px; color:white; font-size:14px; font-weight:bold;">é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œ âœ…</div>
        </div>
    </div>

    <script>
        // --- é€»è¾‘å®šä¹‰åŒº ---
        
        const questions = [
            "å¦‚æœä½ çš„å¥½æœ‹å‹å’Œåˆ«äººå‡ºå»ç©æ²¡å«ä½ ï¼Œä½ ä¼šæ„Ÿåˆ°å¤±è½ã€‚",
            "ä½ å¸Œæœ›æˆä¸ºå¯¹æ–¹å¿ƒé‡Œâ€œå”¯ä¸€â€æœ€å¥½çš„æœ‹å‹ã€‚",
            "å¦‚æœå¥½æœ‹å‹æœ‰äº†æ–°æœ‹å‹ï¼Œä½ ä¼šæ‹…å¿ƒè‡ªå·±è¢«å–ä»£ã€‚",
            "ä½ ä¸å–œæ¬¢å¥½æœ‹å‹åœ¨ä½ é¢å‰é¢‘ç¹å¤¸èµå¦ä¸€ä¸ªäººã€‚",
            "ä½ å¸Œæœ›å¥½æœ‹å‹çš„ç§˜å¯†åªå‘Šè¯‰ä½ ä¸€ä¸ªäººã€‚",
            "å¦‚æœå¥½æœ‹å‹å›å¤åˆ«äººçš„æ¶ˆæ¯æ¯”å›ä½ å¿«ï¼Œä½ ä¼šåƒé†‹ã€‚",
            "ä½ è®¤ä¸ºå¥½æœ‹å‹ä¹‹é—´ä¸åº”è¯¥æœ‰ä»»ä½•ç§˜å¯†ã€‚",
            "çœ‹åˆ°å¥½æœ‹å‹å’Œåˆ«äººç”¨åŒæ¬¾å¤´åƒæˆ–ç½‘åï¼Œä½ ä¼šå¿ƒé‡Œä¸èˆ’æœã€‚",
            "ä½ å¸¸å¸¸ç¿»çœ‹å¥½æœ‹å‹çš„ç¤¾äº¤åŠ¨æ€ï¼Œçœ‹è°ç»™TAç‚¹èµç•™è¨€ã€‚",
            "å¦‚æœå¥½æœ‹å‹æƒ³ç‹¬è‡ªæ—…è¡Œæˆ–åšæŸäº‹ï¼Œä½ ä¼šè§‰å¾—è¢«æ’æ–¥ã€‚",
            "ä½ å¸Œæœ›å¥½æœ‹å‹çš„å¤§éƒ¨åˆ†ç©ºé—²æ—¶é—´éƒ½ç•™ç»™ä½ ã€‚",
            "å¦‚æœå¥½æœ‹å‹å› ä¸ºå¿™ç¢Œå¿½ç•¥äº†ä½ ï¼Œä½ ä¼šè§‰å¾—TAä¸é‡è§†è¿™æ®µå‹è°Šã€‚",
            "ä½ å¾ˆéš¾æ¥å—å¥½æœ‹å‹æœ‰ä½ ä¸çŸ¥é“çš„è¿‡å»æˆ–æœ‹å‹åœˆã€‚",
            "å½“å¥½æœ‹å‹å’Œå…¶ä»–äººèŠå¤©å¾ˆå¼€å¿ƒæ—¶ï¼Œä½ ä¼šæƒ³æ‰“æ–­æˆ–åŠ å…¥ã€‚",
            "ä½ è®¤ä¸ºâ€œæŠ¥å¤‡è¡Œè¸ªâ€æ˜¯å¥½æœ‹å‹ä¹‹é—´é»˜å¥‘çš„ä¸€éƒ¨åˆ†ã€‚",
            "ä½ ç»å¸¸é—®å¥½æœ‹å‹â€œæˆ‘å’ŒXXXè°æ›´é‡è¦â€è¿™ç±»é—®é¢˜ã€‚",
            "å¦‚æœå¥½æœ‹å‹å¯¹ä½ çš„æ€åº¦ç¨å¾®å†·æ·¡ï¼Œä½ ä¼šé™·å…¥è‡ªæˆ‘æ€€ç–‘ã€‚",
            "ä½ ä¸å–œæ¬¢å¥½æœ‹å‹åœ¨æ²¡æœ‰ä½ çš„æƒ…å†µä¸‹ç©å¾—å¤ªå—¨ã€‚",
            "ä½ è§‰å¾—å¥½æœ‹å‹çš„ç¤¾äº¤åœˆå¤ªå¹¿æ˜¯ä¸€ç§å¨èƒã€‚",
            "ä½ å¸Œæœ›åœ¨å¥½æœ‹å‹çš„å©šç¤¼ä¸Šï¼Œä¼´éƒ/ä¼´å¨˜åªèƒ½æ˜¯ä½ ã€‚",
            "ä½ ä¼šå› ä¸ºå¥½æœ‹å‹æ²¡æ³¨æ„åˆ°ä½ çš„æ–°å˜åŒ–è€Œç”Ÿæ°”ã€‚",
            "ä½ å€¾å‘äºå¸®å¥½æœ‹å‹åšå†³å®šï¼Œè§‰å¾—æ˜¯ä¸ºTAå¥½ã€‚",
            "å¦‚æœå¥½æœ‹å‹æ¢äº†æ–°ç¯å¢ƒï¼ˆå¦‚æ–°å­¦æ ¡/å·¥ä½œï¼‰ï¼Œä½ ä¼šæåº¦ç„¦è™‘TAå˜å¿ƒã€‚",
            "ä½ ä¸å–œæ¬¢å¥½æœ‹å‹æåŠTAä»¥å‰çš„æœ‹å‹ã€‚",
            "ä½ æœ‰æ—¶ä¼šæ•…æ„å†·è½å¥½æœ‹å‹ï¼Œçœ‹TAä¼šä¸ä¼šæ¥å“„ä½ ã€‚",
            "ä½ å¾ˆéš¾ä¿¡ä»»å¥½æœ‹å‹èº«è¾¹çš„æ–°é¢å­”ã€‚",
            "å¦‚æœå¥½æœ‹å‹æƒ³æ‹¥æœ‰ç‹¬å¤„ç©ºé—´ï¼Œä½ ä¼šè§‰å¾—è¿™æ˜¯å…³ç³»çš„ç–è¿œã€‚",
            "ä½ ä¼šé™åˆ¶å¥½æœ‹å‹å’Œä½ ä¸å–œæ¬¢çš„äººæ¥å¾€ã€‚",
            "ä½ ç»å¸¸æ‹¿è‡ªå·±å’Œå¥½æœ‹å‹èº«è¾¹çš„å…¶ä»–äººåšæ¯”è¾ƒã€‚",
            "ä½ è®¤ä¸ºå¥½æœ‹å‹åº”è¯¥æ— æ¡ä»¶ç«™åœ¨ä½ è¿™è¾¹ï¼Œå³ä½¿ä½ åšé”™äº†ã€‚",
            "å¦‚æœå¥½æœ‹å‹ä¸å‘ä½ ä»¬çš„åˆç…§åœ¨æœ‹å‹åœˆï¼Œä½ ä¼šä»‹æ„ã€‚",
            "ä½ å¾ˆéš¾å¿å—å¥½æœ‹å‹æœ‰äº‹æƒ…ç’ç€ä½ ã€‚",
            "ä½ ä¼šè„‘è¡¥å¥½æœ‹å‹èƒŒå›ä½ æˆ–æŠ›å¼ƒä½ çš„åœºæ™¯ã€‚",
            "ä½ è§‰å¾—ä¸ºäº†å‹è°Šï¼Œç‰ºç‰²ä¸€éƒ¨åˆ†ä¸ªäººè‡ªç”±æ˜¯åº”è¯¥çš„ã€‚",
            "ä½ æ›¾æš—ç¤ºå¥½æœ‹å‹ç–è¿œæŸäº›äººã€‚",
            "ä½ å¯¹å¥½æœ‹å‹çš„ç”Ÿæ´»ç»†èŠ‚äº†è§£å¾—è¶Šæ¸…æ¥šï¼Œè¶Šæœ‰å®‰å…¨æ„Ÿã€‚",
            "ä½ è®¤ä¸ºæœ€å¥½çš„æœ‹å‹ä¹‹é—´åº”è¯¥å…±äº«å¾ˆå¤šè´¦å·å¯†ç ã€‚",
            "ä½ ä¼šé€šè¿‡å¥½æœ‹å‹çš„ç¤¾äº¤è½¯ä»¶åœ¨çº¿çŠ¶æ€æ¥æ¨æµ‹TAåœ¨å¹²å˜›ã€‚",
            "ä½ å¾ˆéš¾æ¥å—å¥½æœ‹å‹åœ¨åµæ¶åé€‰æ‹©å†·æˆ˜æˆ–å›é¿ã€‚",
            "ä½ è§‰å¾—ä½ çš„æƒ…ç»ªå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¥½æœ‹å‹å¯¹ä½ çš„æ€åº¦ã€‚",
            "å¦‚æœå¥½æœ‹å‹æ²¡é€ä½ ç”Ÿæ—¥ç¤¼ç‰©æˆ–ç¤¼ç‰©ä¸åˆå¿ƒæ„ï¼Œä½ ä¼šè´¨ç–‘å‹è°Šã€‚",
            "ä½ å¸Œæœ›å¥½æœ‹å‹çš„æœªæ¥è§„åˆ’é‡Œä¸€å®šè¦æœ‰ä½ ã€‚",
            "ä¸ºäº†ç•™ä½è¿™ä¸ªæœ‹å‹ï¼Œä½ æ„¿æ„ä¸€å‘³è¿å°±ã€‚",
            "ä½ æ— æ³•å¿å—å¥½æœ‹å‹å’Œä½ çš„æ­»å¯¹å¤´è¯´è¯ã€‚",
            "å½“å¥½æœ‹å‹å‘ä½ åæ§½åˆ«äººæ—¶ï¼Œä½ ä¼šæš—è‡ªé«˜å…´ï¼Œè§‰å¾—ä½ ä»¬æ›´äº²å¯†äº†ã€‚",
            "ä½ å¸Œæœ›å¥½æœ‹å‹çš„ç¬¬ä¸€æ±‚åŠ©å¯¹è±¡æ°¸è¿œæ˜¯ä½ ã€‚",
            "å¦‚æœå¥½æœ‹å‹å’Œåˆ«äººæœ‰äº†åªå±äºä»–ä»¬çš„æ¢—ï¼Œä½ ä¼šå¾ˆéš¾è¿‡ã€‚",
            "ä½ ç»å¸¸ç¡®è®¤è‡ªå·±åœ¨å¯¹æ–¹å¿ƒä¸­çš„æ’åã€‚",
            "ä½ è§‰å¾—çœŸæ­£çš„å‹è°Šå°±æ˜¯å æœ‰ã€‚",
            "å¦‚æœè¿™æ®µå‹è°Šç»“æŸï¼Œä½ ä¼šè§‰å¾—ä¸–ç•Œå´©å¡Œäº†ã€‚"
        ];

        let currentIdx = 0;
        let totalScore = 0;
        
        const options = [
            { t: "éå¸¸ç¬¦åˆ", s: 5 },
            { t: "æ¯”è¾ƒç¬¦åˆ", s: 4 },
            { t: "ä¸€èˆ¬ / ä¸ç¡®å®š", s: 3 },
            { t: "æ¯”è¾ƒä¸ç¬¦åˆ", s: 2 },
            { t: "å®Œå…¨ä¸ç¬¦åˆ", s: 1 }
        ];

        function showPage(pageId) {
            document.querySelectorAll('.container').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            const bottomBar = document.getElementById('bottom-bar');
            const topBar = document.querySelector('.top-bar');
            
            if(pageId === 'page-result') {
                bottomBar.style.display = 'flex';
                topBar.style.display = 'none';
            } else {
                bottomBar.style.display = 'none';
                topBar.style.display = 'block';
            }
            window.scrollTo(0,0);
        }

        function startTest() {
            currentIdx = 0;
            totalScore = 0;
            renderQuestion();
            showPage('page-playing');
        }

        function renderQuestion() {
            // Update Top Progress Bar
            document.getElementById('top-progress').style.width = ((currentIdx + 1) / questions.length * 100) + "%";
            
            document.getElementById('curr-q').innerText = currentIdx + 1;
            document.getElementById('q-number').innerText = "Q" + (currentIdx + 1);
            document.getElementById('q-content').innerText = questions[currentIdx];

            const optsDiv = document.getElementById('options-container');
            optsDiv.innerHTML = '';
            
            options.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerHTML = `<span>${opt.t}</span><span style="width:18px;height:18px;border:2px solid #e5e7eb;border-radius:50%;"></span>`;
                btn.onclick = () => handleAnswer(opt.s);
                optsDiv.appendChild(btn);
            });
        }

        function handleAnswer(score) {
            totalScore += score;
            if (currentIdx < questions.length - 1) {
                currentIdx++;
                const content = document.getElementById('q-content');
                content.style.opacity = 0;
                setTimeout(() => {
                    renderQuestion();
                    content.style.opacity = 1;
                }, 150);
            } else {
                calculateAndShowResult();
            }
        }

        function calculateAndShowResult() {
            const finalScore = Math.round((totalScore / (questions.length * 5)) * 100);
            const res = analyze(finalScore);
            
            document.getElementById('res-score').innerText = finalScore;
            
            const levelPill = document.getElementById('res-level');
            levelPill.innerText = res.level;
            levelPill.style.color = res.fg;
            
            document.getElementById('res-attachment').innerText = res.attachment;
            document.getElementById('res-desc').innerText = res.description;
            document.getElementById('res-behavior').innerText = res.behavior;
            document.getElementById('res-partner').innerText = res.partner_suggestion;
            document.getElementById('res-blind').innerText = res.blind_spot;
            document.getElementById('res-advice').innerText = res.advice;

            showPage('page-result');
        }

        function analyze(score) {
            if (score <= 25) {
                return {
                    level: "ä½›ç³»/ç‹¬ç«‹å‹", fg: "#15803d",
                    attachment: "å®‰å…¨ç‹¬ç«‹å‹ (Independent)",
                    description: "ä½ å¯¹å‹è°Šçš„å æœ‰æ¬²æä½ï¼Œç”šè‡³è®©äººè§‰å¾—æœ‰ç‚¹â€œå›å­ä¹‹äº¤æ·¡å¦‚æ°´â€ã€‚ä½ éå¸¸å°Šé‡æœ‹å‹çš„ç‹¬ç«‹ç©ºé—´ï¼Œè®¤ä¸ºæ¯ä¸ªäººéƒ½æ˜¯è‡ªç”±çš„ä¸ªä½“ã€‚ä½ ä¸ä»‹æ„æœ‹å‹æœ‰å…¶ä»–åœˆå­ï¼Œç”šè‡³ä¹äºè§åˆ°ä»–ä»¬æ‹“å±•ç¤¾äº¤ã€‚",
                    behavior: "æœ‹å‹é•¿æ—¶é—´ä¸è”ç³»ä½ ä¹Ÿä¸ä¼šç„¦è™‘ï¼Œç›¸ä¿¡â€œåªè¦å¿ƒé‡Œæœ‰ï¼Œæ— éœ€å¤©å¤©é»â€ã€‚ä»ä¸æŸ¥å²—ï¼Œä¸åƒé†‹ï¼Œå¯¹æœ‹å‹çš„æ–°ä¼™ä¼´æŒæ¬¢è¿æ€åº¦ã€‚",
                    partner_suggestion: "åŒæ ·ç‹¬ç«‹ã€æœ‰ä¸»è§çš„æœ‹å‹ã€‚",
                    blind_spot: "å®¹æ˜“å› ä¸ºè¿‡äºç–ç¦»ï¼Œè®©æ•æ„Ÿçš„æœ‹å‹è§‰å¾—ä½ â€œä¸åœ¨ä¹â€ã€‚",
                    advice: "é€‚åº¦è¡¨è¾¾ä½ çš„åœ¨ä¹ã€‚å¶å°”çš„ä¸»åŠ¨é‚€çº¦å’Œæƒ…æ„Ÿæµéœ²ï¼Œä¼šè®©æœ‹å‹æ„Ÿåˆ°æ¸©æš–ã€‚"
                };
            } else if (score <= 50) {
                return {
                    level: "å¥åº·/å¹³è¡¡å‹", fg: "#1d4ed8",
                    attachment: "å®‰å…¨ä¾æ‹å‹ (Secure)",
                    description: "ä½ çš„å‹æƒ…è§‚éå¸¸å¥åº·æˆç†Ÿã€‚ä½ æ—¢èƒ½äº«å—å’Œæœ‹å‹äº²å¯†æ— é—´çš„æ—¶å…‰ï¼Œä¹Ÿèƒ½æ¥å—å½¼æ­¤æ‹¥æœ‰ç‹¬ç«‹çš„ç”Ÿæ´»ã€‚ä½ ä¿¡ä»»æœ‹å‹ï¼Œä¸ä¼šå› ä¸ºä»–ä»¬æœ‰äº†æ–°æœ‹å‹å°±æ‚£å¾—æ‚£å¤±ã€‚",
                    behavior: "å¶å°”ä¼šåƒç‚¹å°é†‹ï¼Œä½†è¿™æ›´å¤šæ˜¯å‹è°Šçš„è°ƒå‘³å‰‚ã€‚ä½ ä¼šä¸ºæœ‹å‹çš„å¼€å¿ƒè€Œå¼€å¿ƒï¼Œå³ä½¿é‚£ä»½å¼€å¿ƒä¸æ˜¯ä½ å¸¦æ¥çš„ã€‚ä½ æ˜¯æœ‹å‹åœˆé‡Œçš„å®šæµ·ç¥é’ˆã€‚",
                    partner_suggestion: "ä½ æ˜¯ä¸‡èƒ½å‹æœ‹å‹ã€‚æ— è®ºæ˜¯é»äººçš„è¿˜æ˜¯é«˜å†·çš„ï¼Œéƒ½èƒ½å’Œä½ ç›¸å¤„å¾—å¾ˆèˆ’æœã€‚",
                    blind_spot: "æœ‰æ—¶å€™å¯èƒ½è¿‡äºç†æ€§ï¼Œéš¾ä»¥å…±æƒ…é‚£äº›æåº¦ç¼ºä¹å®‰å…¨æ„Ÿçš„æœ‹å‹çš„æƒ…ç»ªçˆ†å‘ã€‚",
                    advice: "ä¿æŒè¿™ç§çŠ¶æ€ï¼ä½ æ˜¯éå¸¸ç†æƒ³çš„æŒšå‹ï¼Œç»§ç»­ç”¨ä½ çš„åŒ…å®¹å’Œä¿¡ä»»å»æ»‹å…»èº«è¾¹çš„å…³ç³»ã€‚"
                };
            } else if (score <= 75) {
                return {
                    level: "ç„¦è™‘/é»äººå‹", fg: "#b45309",
                    attachment: "ç„¦è™‘ä¾æ‹å‹ (Anxious)",
                    description: "ä½ å¯¹å¥½æœ‹å‹æœ‰è¾ƒå¼ºçš„ä¾èµ–å’Œå æœ‰æ¬²ã€‚ä½ éå¸¸çœ‹é‡å‹è°Šï¼Œå®³æ€•è¢«å†·è½æˆ–è¢«å–ä»£ã€‚ä½ æ¸´æœ›æˆä¸ºå¯¹æ–¹å¿ƒä¸­â€œæœ€ç‰¹åˆ«â€çš„é‚£ä¸€ä¸ªï¼Œä¸€æ—¦æ„Ÿè§‰åœ°ä½åŠ¨æ‘‡ï¼Œå°±ä¼šéå¸¸ä¸å®‰ã€‚",
                    behavior: "å¯¹æœ‹å‹çš„å›å¤é€Ÿåº¦æ•æ„Ÿï¼Œå–œæ¬¢â€œè¿ä½“å©´â€å¼çš„ç›¸å¤„ã€‚å¦‚æœæœ‹å‹å’Œåˆ«äººç©å¾—å¥½ï¼Œä½ ä¼šå·å·éš¾è¿‡æˆ–èµŒæ°”ã€‚ä½ ä»˜å‡ºçš„æ„Ÿæƒ…å¾ˆæµ“çƒˆï¼Œä½†æœ‰æ—¶ä¼šè®©æœ‹å‹æ„Ÿåˆ°å‹åŠ›ã€‚",
                    partner_suggestion: "æƒ…ç»ªç¨³å®šã€äº‹äº‹æœ‰å›åº”ã€èƒ½ç»™ä½ è¶³å¤Ÿå®‰å…¨æ„Ÿçš„æœ‹å‹ã€‚",
                    blind_spot: "å®¹æ˜“æŠŠå‹è°Šå˜æˆâ€œæ’ä»–æ€§â€çš„äºŒäººä¸–ç•Œï¼Œåè€Œé™åˆ¶äº†å½¼æ­¤çš„æˆé•¿ã€‚",
                    advice: "å»ºç«‹â€œè‡ªæˆ‘å®‰å…¨æ„Ÿâ€ã€‚è®°ä½ï¼Œæœ‹å‹æœ‰å…¶ä»–æœ‹å‹ï¼Œå¹¶ä¸ä»£è¡¨ä½ ä¸é‡è¦ã€‚"
                };
            } else {
                return {
                    level: "æè‡´/éœ¸é“å‹", fg: "#b91c1c",
                    attachment: "å¼ºå æœ‰å‹ (Possessive)",
                    description: "ä½ å¯¹å‹è°Šæœ‰ç€æå¼ºçš„æ’ä»–æ€§å’Œæ§åˆ¶æ¬²ã€‚ä½ å¸Œæœ›å®Œå…¨å æ®å¥½æœ‹å‹çš„æ—¶é—´å’Œæ³¨æ„åŠ›ï¼Œè§†å¯¹æ–¹ä¸ºç§æœ‰è´¢äº§ã€‚ä»»ä½•â€œç¬¬ä¸‰è€…â€çš„ä»‹å…¥éƒ½ä¼šå¼•å‘ä½ çš„å¼ºçƒˆè­¦è§‰å’Œæ•Œæ„ã€‚",
                    behavior: "è¦æ±‚æœ‹å‹ç§’å›ï¼Œé™åˆ¶æœ‹å‹çš„ç¤¾äº¤åœˆï¼Œç”šè‡³å¸Œæœ›æœ‹å‹å’Œä½ ä¸å–œæ¬¢çš„äººæ–­äº¤ã€‚ä½ çš„å‹è°Šä¼´éšç€å¼ºçƒˆçš„å«‰å¦’å¿ƒå’Œæ§åˆ¶æ¬²ï¼Œå®¹æ˜“æ¼”å˜æˆâ€œè¦ä¹ˆå¬æˆ‘çš„ï¼Œè¦ä¹ˆç»äº¤â€ã€‚",
                    partner_suggestion: "åŒ…å®¹æ€§æå¼ºã€æ€§æ ¼æ¸©å’Œä½†æœ‰åŸåˆ™çš„æœ‹å‹ã€‚",
                    blind_spot: "è¿‡åº¦çš„æ§åˆ¶ä¼šè®©æœ‹å‹æ„Ÿåˆ°çª’æ¯è€Œæƒ³è¦é€ƒç¦»ï¼Œæœ€ç»ˆå¯¼è‡´ä½ æœ€å®³æ€•çš„â€œå¤±å»â€æˆçœŸã€‚",
                    advice: "å‹è°Šéœ€è¦å‘¼å¸ç©ºé—´ã€‚æ„è¯†åˆ°æœ‹å‹æ˜¯ç‹¬ç«‹çš„ä¸ªä½“ã€‚å­¦ä¼šæ”¾æ‰‹ï¼Œå…³ç³»åè€Œæ›´é•¿ä¹…ã€‚"
                };
            }
        }

        function restartTest() {
            showPage('page-intro');
        }

        function saveReport() {
            const btn = document.getElementById('save-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = 'ç”Ÿæˆä¸­...';
            
            const area = document.getElementById('capture-area');
            
            if(typeof html2canvas !== 'undefined') {
                html2canvas(area, {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: "#ffffff"
                }).then(canvas => {
                    const imgData = canvas.toDataURL("image/png");
                    document.getElementById('generated-img').src = imgData;
                    document.getElementById('img-modal').classList.add('show');
                    btn.innerHTML = originalText;
                }).catch(err => {
                    alert("ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç›´æ¥æ‰‹æœºæˆªå±ä¿å­˜");
                    btn.innerHTML = originalText;
                });
            } else {
                alert("ç»„ä»¶åŠ è½½ä¸­ï¼Œè¯·ç¨åå†è¯•æˆ–ç›´æ¥æˆªå±");
                btn.innerHTML = originalText;
            }
        }

        function closeModal() {
            document.getElementById('img-modal').classList.remove('show');
        }
    </script>
</body>
</html>
